<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–æ–≤ - –ì–∞–∑–ø—Ä–æ–º</title>
    <link rel="stylesheet" href="../style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        .report-generator {
            max-width: 1000px;
            margin: 2rem auto;
        }
        
        .report-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .report-preview {
            background-color: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 2rem;
            min-height: 500px;
        }
        
        .template-selector {
            margin-bottom: 2rem;
        }
        
        .template-options {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        
        .template-option {
            border: 1px solid var(--gray);
            border-radius: 8px;
            padding: 1rem;
            cursor: pointer;
            transition: var(--transition);
            width: 200px;
        }
        
        .template-option:hover {
            border-color: var(--primary-color);
        }
        
        .template-option.selected {
            border-color: var(--primary-color);
            background-color: var(--primary-light);
        }
        
        .template-option img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 4px;
            margin-bottom: 0.5rem;
        }
        
        .report-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--primary-dark);
        }
        
        .report-content {
            margin-top: 2rem;
        }
        
        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        
        .report-table th, .report-table td {
            border: 1px solid var(--gray);
            padding: 0.75rem;
            text-align: left;
        }
        
        .report-table th {
            background-color: var(--primary-light);
        }
        
        .data-input {
            margin-top: 2rem;
        }
        
        .data-input textarea {
            width: 100%;
            height: 200px;
            padding: 1rem;
            border: 1px solid var(--gray);
            border-radius: 4px;
            font-family: monospace;
        }
        
        .data-format-info {
            font-size: 0.9rem;
            color: var(--dark-gray);
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-container">
                <div class="logo">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Gazprom_logo.svg/1200px-Gazprom_logo.svg.png" alt="–ì–∞–∑–ø—Ä–æ–º" class="logo-img">
                    <div class="logo-text">
                        <span class="logo-title">–ì–∞–∑–ø—Ä–æ–º</span>
                        <span class="logo-subtitle">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–æ–≤</span>
                    </div>
                </div>
                
                <nav class="main-nav">
                    <ul class="nav-list">
                        <li class="nav-item"><a href="../index.html" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a></li>
                        <li class="nav-item"><a href="index.html" class="nav-link active">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</a></li>
                        <li class="nav-item"><a href="../trainers/index.html" class="nav-link">–¢—Ä–µ–Ω–∞–∂—ë—Ä—ã</a></li>
                        <li class="nav-item"><a href="../visualization/index.html" class="nav-link">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a></li>
                        <li class="nav-item"><a href="../ai-assistant/index.html" class="nav-link">–ü–æ–º–æ—â–Ω–∏–∫</a></li>
                    </ul>
                </nav>
                
                <button class="mobile-menu-btn">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <main class="main">
        <section class="section-header">
            <div class="container">
                <h1 class="section-title">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–æ–≤</h1>
                <p class="section-subtitle">–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö</p>
            </div>
        </section>

        <section class="report-generator">
            <div class="container">
                <div class="template-selector">
                    <h3>–í—ã–±–µ—Ä–∏—Ç–µ —à–∞–±–ª–æ–Ω –æ—Ç—á–µ—Ç–∞</h3>
                    <div class="template-options">
                        <div class="template-option selected" data-template="financial">
                            <img src="https://images.unsplash.com/photo-1554224155-6726b3ff858f?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç">
                            <h4>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç</h4>
                        </div>
                        <div class="template-option" data-template="production">
                            <img src="https://images.unsplash.com/photo-1581093450021-4a7360e9a6a8?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç—á–µ—Ç">
                            <h4>–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç—á–µ—Ç</h4>
                        </div>
                        <div class="template-option" data-template="sales">
                            <img src="https://images.unsplash.com/photo-1556740738-b6a63e27c4df?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="–û—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º">
                            <h4>–û—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º</h4>
                        </div>
                    </div>
                </div>
                
                <div class="report-controls">
                    <button class="btn btn-primary" onclick="generatePDF()">
                        <i class="fas fa-file-pdf"></i> –°–∫–∞—á–∞—Ç—å PDF
                    </button>
                    <button class="btn btn-primary" onclick="generateExcel()">
                        <i class="fas fa-file-excel"></i> –°–∫–∞—á–∞—Ç—å Excel
                    </button>
                    <button class="btn btn-primary" onclick="generateWord()">
                        <i class="fas fa-file-word"></i> –°–∫–∞—á–∞—Ç—å Word
                    </button>
                    <div style="flex-grow: 1;"></div>
                    <button class="btn" onclick="loadSampleData()">
                        <i class="fas fa-database"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö
                    </button>
                </div>
                
                <div class="data-input">
                    <h3>–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç—á–µ—Ç–∞ (JSON —Ñ–æ—Ä–º–∞—Ç)</h3>
                    <textarea id="report-data-input" placeholder='{
  "title": "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç –∑–∞ Q1 2025",
  "headers": ["–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å", "–Ø–Ω–≤–∞—Ä—å", "–§–µ–≤—Ä–∞–ª—å", "–ú–∞—Ä—Ç", "–ò—Ç–æ–≥–æ"],
  "rows": [
    ["–î–æ–±—ã—á–∞ –≥–∞–∑–∞ (–º–ª–Ω –º¬≥)", 1250, 1320, 1400, 3970],
    ["–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–∞–∑–∞ (–º–ª–Ω –º¬≥)", 1180, 1250, 1320, 3750],
    ["–í—ã—Ä—É—á–∫–∞ (–º–ª–Ω —Ä—É–±)", 45200, 47800, 50300, 143300],
    ["–†–∞—Å—Ö–æ–¥—ã (–º–ª–Ω —Ä—É–±)", 28500, 29300, 30200, 88000],
    ["–ü—Ä–∏–±—ã–ª—å (–º–ª–Ω —Ä—É–±)", 16700, 18500, 20100, 55300]
  ]
}'></textarea>
                    <div class="data-format-info">
                        –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö: JSON –æ–±—ä–µ–∫—Ç —Å –ø–æ–ª—è–º–∏ title (–∑–∞–≥–æ–ª–æ–≤–æ–∫), headers (–∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å—Ç–æ–ª–±—Ü–æ–≤), rows (—Å—Ç—Ä–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö)
                    </div>
                    <button class="btn btn-primary" onclick="updateReportFromInput()" style="margin-top: 1rem;">
                        <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç—á–µ—Ç
                    </button>
                </div>
                
                <div class="report-preview" id="report-preview">
                    <h2 class="report-title" id="report-title">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç –∑–∞ Q1 2025</h2>
                    <div class="report-content">
                        <table class="report-table">
                            <thead>
                                <tr id="report-headers">
                                    <th>–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å</th>
                                    <th>–Ø–Ω–≤–∞—Ä—å</th>
                                    <th>–§–µ–≤—Ä–∞–ª—å</th>
                                    <th>–ú–∞—Ä—Ç</th>
                                    <th>–ò—Ç–æ–≥–æ</th>
                                </tr>
                            </thead>
                            <tbody id="report-rows">
                                <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-container">
                <div class="footer-column">
                    <h4 class="footer-title">–ì–∞–∑–ø—Ä–æ–º</h4>
                    <p class="footer-text">–ö—Ä—É–ø–Ω–µ–π—à–∞—è –≥–∞–∑–æ–≤–∞—è –∫–æ–º–ø–∞–Ω–∏—è –º–∏—Ä–∞, –ª–∏–¥–µ—Ä –≤ –æ–±–ª–∞—Å—Ç–∏ —Ä–∞–∑–≤–µ–¥–∫–∏, –¥–æ–±—ã—á–∏, —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, —Ö—Ä–∞–Ω–µ–Ω–∏—è, –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —É–≥–ª–µ–≤–æ–¥–æ—Ä–æ–¥–æ–≤.</p>
                </div>
                
                <div class="footer-column">
                    <h4 class="footer-title">–ù–∞–≤–∏–≥–∞—Ü–∏—è</h4>
                    <ul class="footer-links">
                        <li><a href="../index.html" class="footer-link">–ì–ª–∞–≤–Ω–∞—è</a></li>
                        <li><a href="index.html" class="footer-link">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</a></li>
                        <li><a href="../trainers/index.html" class="footer-link">–¢—Ä–µ–Ω–∞–∂—ë—Ä—ã</a></li>
                        <li><a href="../visualization/index.html" class="footer-link">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h4 class="footer-title">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
                    <ul class="footer-contacts">
                        <li class="contact-item">
                            <span class="contact-icon">üìû</span>
                            <span>+7 (495) 719-30-01</span>
                        </li>
                        <li class="contact-item">
                            <span class="contact-icon">‚úâÔ∏è</span>
                            <span>portal@gazprom.ru</span>
                        </li>
                        <li class="contact-item">
                            <span class="contact-icon">üìç</span>
                            <span>–ú–æ—Å–∫–≤–∞, —É–ª. –ù–∞–º–µ—Ç–∫–∏–Ω–∞, 16</span>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>¬© 2025 –ü–ê–û "–ì–∞–∑–ø—Ä–æ–º". –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
                <div class="footer-links">
                    <a href="#" class="footer-link">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
                    <a href="#" class="footer-link">–£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è jsPDF
        const { jsPDF } = window.jspdf;
        let currentTemplate = 'financial';
        let reportData = {
            title: "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç –∑–∞ Q1 2025",
            headers: ["–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å", "–Ø–Ω–≤–∞—Ä—å", "–§–µ–≤—Ä–∞–ª—å", "–ú–∞—Ä—Ç", "–ò—Ç–æ–≥–æ"],
            rows: [
                ["–î–æ–±—ã—á–∞ –≥–∞–∑–∞ (–º–ª–Ω –º¬≥)", 1250, 1320, 1400, 3970],
                ["–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–∞–∑–∞ (–º–ª–Ω –º¬≥)", 1180, 1250, 1320, 3750],
                ["–í—ã—Ä—É—á–∫–∞ (–º–ª–Ω —Ä—É–±)", 45200, 47800, 50300, 143300],
                ["–†–∞—Å—Ö–æ–¥—ã (–º–ª–Ω —Ä—É–±)", 28500, 29300, 30200, 88000],
                ["–ü—Ä–∏–±—ã–ª—å (–º–ª–Ω —Ä—É–±)", 16700, 18500, 20100, 55300]
            ]
        };
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞
        function loadSampleData() {
            const templateData = {
                financial: {
                    title: "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç –∑–∞ Q1 2025",
                    headers: ["–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å", "–Ø–Ω–≤–∞—Ä—å", "–§–µ–≤—Ä–∞–ª—å", "–ú–∞—Ä—Ç", "–ò—Ç–æ–≥–æ"],
                    rows: [
                        ["–î–æ–±—ã—á–∞ –≥–∞–∑–∞ (–º–ª–Ω –º¬≥)", 1250, 1320, 1400, 3970],
                        ["–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–∞–∑–∞ (–º–ª–Ω –º¬≥)", 1180, 1250, 1320, 3750],
                        ["–í—ã—Ä—É—á–∫–∞ (–º–ª–Ω —Ä—É–±)", 45200, 47800, 50300, 143300],
                        ["–†–∞—Å—Ö–æ–¥—ã (–º–ª–Ω —Ä—É–±)", 28500, 29300, 30200, 88000],
                        ["–ü—Ä–∏–±—ã–ª—å (–º–ª–Ω —Ä—É–±)", 16700, 18500, 20100, 55300]
                    ]
                },
                production: {
                    title: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç—á–µ—Ç –∑–∞ Q1 2025",
                    headers: ["–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å", "–Ø–Ω–≤–∞—Ä—å", "–§–µ–≤—Ä–∞–ª—å", "–ú–∞—Ä—Ç", "–ò—Ç–æ–≥–æ"],
                    rows: [
                        ["–î–æ–±—ã—á–∞ –Ω–µ—Ñ—Ç–∏ (—Ç—ã—Å. —Ç–æ–Ω–Ω)", 1250, 1320, 1400, 3970],
                        ["–î–æ–±—ã—á–∞ –≥–∞–∑–∞ (–º–ª–Ω –º¬≥)", 45200, 47800, 50300, 143300],
                        ["–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Ñ—Ç–∏ (—Ç—ã—Å. —Ç–æ–Ω–Ω)", 28500, 29300, 30200, 88000],
                        ["–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –ì–°–ú (—Ç—ã—Å. —Ç–æ–Ω–Ω)", 16700, 18500, 20100, 55300]
                    ]
                },
                sales: {
                    title: "–û—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º –∑–∞ Q1 2025",
                    headers: ["–†–µ–≥–∏–æ–Ω", "–Ø–Ω–≤–∞—Ä—å", "–§–µ–≤—Ä–∞–ª—å", "–ú–∞—Ä—Ç", "–ò—Ç–æ–≥–æ"],
                    rows: [
                        ["–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π", 1250, 1320, 1400, 3970],
                        ["–°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π", 1180, 1250, 1320, 3750],
                        ["–Æ–∂–Ω—ã–π", 4520, 4780, 5030, 14330],
                        ["–ü—Ä–∏–≤–æ–ª–∂—Å–∫–∏–π", 2850, 2930, 3020, 8800],
                        ["–£—Ä–∞–ª—å—Å–∫–∏–π", 1670, 1850, 2010, 5530]
                    ]
                }
            };
            
            reportData = templateData[currentTemplate];
            document.getElementById('report-data-input').value = JSON.stringify(reportData, null, 2);
            updateReport();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ –∏–∑ –ø–æ–ª—è –≤–≤–æ–¥–∞
        function updateReportFromInput() {
            try {
                const inputData = document.getElementById('report-data-input').value;
                reportData = JSON.parse(inputData);
                updateReport();
            } catch (e) {
                alert('–û—à–∏–±–∫–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –¥–∞–Ω–Ω—ã—Ö: ' + e.message);
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞
        function updateReport() {
            document.getElementById('report-title').textContent = reportData.title;
            
            const headersRow = document.getElementById('report-headers');
            headersRow.innerHTML = '';
            reportData.headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headersRow.appendChild(th);
            });
            
            const rowsBody = document.getElementById('report-rows');
            rowsBody.innerHTML = '';
            reportData.rows.forEach(row => {
                const tr = document.createElement('tr');
                row.forEach((cell, index) => {
                    const td = document.createElement('td');
                    // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —á–∏—Å–ª–∞ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏
                    if (typeof cell === 'number') {
                        td.textContent = cell.toLocaleString();
                    } else {
                        td.textContent = cell;
                    }
                    // –í—ã–¥–µ–ª—è–µ–º –∏—Ç–æ–≥–æ–≤—ã–µ —è—á–µ–π–∫–∏
                    if (index === row.length - 1) {
                        td.style.fontWeight = 'bold';
                    }
                    tr.appendChild(td);
                });
                rowsBody.appendChild(tr);
            });
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF
        function generatePDF() {
            const doc = new jsPDF();
            const title = reportData.title;
            
            doc.setFontSize(18);
            doc.text(title, 14, 20);
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É
            doc.autoTable({
                head: [reportData.headers],
                body: reportData.rows,
                startY: 30,
                theme: 'grid',
                headStyles: {
                    fillColor: [0, 166, 80], // –¶–≤–µ—Ç –∫–∞–∫ –≤ —Å—Ç–∏–ª—è—Ö
                    textColor: 255
                }
            });
            
            doc.save(`${title}.pdf`);
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Excel
        function generateExcel() {
            const workbook = XLSX.utils.book_new();
            const worksheet = XLSX.utils.aoa_to_sheet([
                [reportData.title],
                [],
                reportData.headers,
                ...reportData.rows
            ]);
            
            // –û–±—ä–µ–¥–∏–Ω—è–µ–º —è—á–µ–π–∫–∏ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞
            worksheet['!merges'] = [
                { s: { r: 0, c: 0 }, e: { r: 0, c: reportData.headers.length - 1 } }
            ];
            
            XLSX.utils.book_append_sheet(workbook, worksheet, "–û—Ç—á–µ—Ç");
            XLSX.writeFile(workbook, `${reportData.title}.xlsx`);
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Word (—á–µ—Ä–µ–∑ HTML)
        function generateWord() {
            const htmlContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>${reportData.title}</title>
                    <style>
                        body { font-family: Arial, sans-serif; }
                        h1 { color: #006644; }
                        table { border-collapse: collapse; width: 100%; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #00a650; color: white; }
                        .total { font-weight: bold; }
                    </style>
                </head>
                <body>
                    <h1>${reportData.title}</h1>
                    <table>
                        <thead>
                            <tr>
                                ${reportData.headers.map(h => `<th>${h}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
                            ${reportData.rows.map(row => `
                                <tr>
                                    ${row.map((cell, i) => 
                                        `<td${i === row.length - 1 ? ' class="total"' : ''}>${
                                            typeof cell === 'number' ? cell.toLocaleString() : cell
                                        }</td>`
                                    ).join('')}
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </body>
                </html>
            `;
            
            const blob = new Blob([htmlContent], { type: 'application/msword' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${reportData.title}.doc`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // –í—ã–±–æ—Ä —à–∞–±–ª–æ–Ω–∞
        document.querySelectorAll('.template-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.template-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                this.classList.add('selected');
                
                currentTemplate = this.getAttribute('data-template');
                loadSampleData();
            });
        });
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        document.addEventListener('DOMContentLoaded', loadSampleData);
    </script>
    <script src="../script.js"></script>
</body>
</html>