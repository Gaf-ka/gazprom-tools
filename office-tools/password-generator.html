<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Генератор паролей - Газпром</title>
    <link rel="stylesheet" href="../style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .generator-section {
            padding: 40px 0;
        }
        
        .generator-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .generator-box {
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .generator-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: var(--primary-dark);
            border-bottom: 1px solid #eee;
            padding-bottom: 0.5rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        .form-row {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .password-result {
            background-color: #f8f8f8;
            padding: 1rem;
            border-radius: 4px;
            margin-top: 1rem;
            font-family: monospace;
            font-size: 1.2rem;
            text-align: center;
            word-break: break-all;
        }
        
        .strength-meter {
            height: 10px;
            background-color: #eee;
            border-radius: 5px;
            margin-top: 1rem;
            overflow: hidden;
        }
        
        .strength-bar {
            height: 100%;
            width: 0%;
            transition: width 0.3s;
        }
        
        .strength-weak {
            background-color: #ff5252;
        }
        
        .strength-medium {
            background-color: #ffb74d;
        }
        
        .strength-strong {
            background-color: #4caf50;
        }
        
        .strength-very-strong {
            background-color: #2e7d32;
        }
        
        .strength-label {
            font-size: 0.9rem;
            margin-top: 0.5rem;
            text-align: right;
            font-weight: 500;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .checkbox-group input {
            margin-right: 0.5rem;
        }
        
        .history-list {
            list-style: none;
            margin-top: 1rem;
        }
        
        .history-item {
            padding: 0.5rem;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        .copy-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-container">
                <div class="logo">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Gazprom_logo.svg/1200px-Gazprom_logo.svg.png" alt="Газпром" class="logo-img">
                    <div class="logo-text">
                        <span class="logo-title">Газпром</span>
                        <span class="logo-subtitle">Генератор паролей</span>
                    </div>
                </div>
                
                <nav class="main-nav">
                    <ul class="nav-list">
                        <li class="nav-item"><a href="../index.html" class="nav-link">Главная</a></li>
                        <li class="nav-item"><a href="index.html" class="nav-link">Инструменты</a></li>
                        <li class="nav-item"><a href="../trainers/index.html" class="nav-link">Тренажёры</a></li>
                        <li class="nav-item"><a href="../visualization/index.html" class="nav-link">Аналитика</a></li>
                        <li class="nav-item"><a href="../ai-assistant/index.html" class="nav-link">Помощник</a></li>
                    </ul>
                </nav>
                
                <button class="mobile-menu-btn">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <main class="main">
        <section class="section-header">
            <div class="container">
                <h1 class="section-title">Генератор безопасных паролей</h1>
                <p class="section-subtitle">Создавайте сложные пароли для защиты учетных записей и систем</p>
            </div>
        </section>

        <section class="generator-section">
            <div class="container">
                <div class="generator-container">
                    <div class="generator-box">
                        <h2 class="generator-title">Настройки генерации</h2>
                        
                        <div class="form-group">
                            <label for="password-length">Длина пароля (4-64 символа)</label>
                            <input type="range" id="password-length" min="4" max="64" value="12">
                            <div class="form-row">
                                <span id="length-value">12</span>
                                <span>символов</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Использовать символы:</label>
                            <div class="checkbox-group">
                                <input type="checkbox" id="uppercase" checked>
                                <label for="uppercase">Прописные буквы (A-Z)</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="lowercase" checked>
                                <label for="lowercase">Строчные буквы (a-z)</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="numbers" checked>
                                <label for="numbers">Цифры (0-9)</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="symbols">
                                <label for="symbols">Спецсимволы (!@#$%^&*)</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="ambiguous">
                                <label for="ambiguous">Исключать неоднозначные символы (lI1O0)</label>
                            </div>
                        </div>
                        
                        <button id="generate-btn" class="btn btn-primary">Сгенерировать пароль</button>
                    </div>
                    
                    <div class="generator-box">
                        <h2 class="generator-title">Результат</h2>
                        
                        <div class="form-row">
                            <div class="form-group" style="flex: 3;">
                                <div class="password-result" id="password-result">Нажмите кнопку "Сгенерировать"</div>
                            </div>
                            <button id="copy-btn" class="btn btn-outline" style="flex: 1;">Копировать</button>
                        </div>
                        
                        <div class="strength-meter">
                            <div class="strength-bar" id="strength-bar"></div>
                        </div>
                        <div class="strength-label" id="strength-label">Нажмите "Сгенерировать"</div>
                        
                        <div class="form-group">
                            <label for="password-hash">Хеш пароля (SHA-256)</label>
                            <input type="text" id="password-hash" readonly>
                        </div>
                    </div>
                    
                    <div class="generator-box">
                        <h2 class="generator-title">История генерации</h2>
                        <p>Последние 10 сгенерированных паролей (хранится только в вашем браузере)</p>
                        
                        <ul class="history-list" id="history-list">
                            <li class="history-item">Нет сохраненных паролей</li>
                        </ul>
                        
                        <button id="clear-history" class="btn btn-secondary">Очистить историю</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-container">
                <div class="footer-column">
                    <h4 class="footer-title">Газпром</h4>
                    <p class="footer-text">Крупнейшая газовая компания мира, лидер в области разведки, добычи, транспортировки, хранения, переработки и реализации углеводородов.</p>
                </div>
                
                <div class="footer-column">
                    <h4 class="footer-title">Навигация</h4>
                    <ul class="footer-links">
                        <li><a href="../index.html" class="footer-link">Главная</a></li>
                        <li><a href="index.html" class="footer-link">Инструменты</a></li>
                        <li><a href="../trainers/index.html" class="footer-link">Тренажёры</a></li>
                        <li><a href="../visualization/index.html" class="footer-link">Аналитика</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h4 class="footer-title">Контакты</h4>
                    <ul class="footer-contacts">
                        <li class="contact-item">
                            <span class="contact-icon">📞</span>
                            <span>+7 (495) 719-30-01</span>
                        </li>
                        <li class="contact-item">
                            <span class="contact-icon">✉️</span>
                            <span>portal@gazprom.ru</span>
                        </li>
                        <li class="contact-item">
                            <span class="contact-icon">📍</span>
                            <span>Москва, ул. Наметкина, 16</span>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>© 2025 ПАО "Газпром". Все права защищены.</p>
                <div class="footer-links">
                    <a href="#" class="footer-link">Политика конфиденциальности</a>
                    <a href="#" class="footer-link">Условия использования</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // DOM elements
        const lengthSlider = document.getElementById('password-length');
        const lengthValue = document.getElementById('length-value');
        const uppercaseCheckbox = document.getElementById('uppercase');
        const lowercaseCheckbox = document.getElementById('lowercase');
        const numbersCheckbox = document.getElementById('numbers');
        const symbolsCheckbox = document.getElementById('symbols');
        const ambiguousCheckbox = document.getElementById('ambiguous');
        const generateBtn = document.getElementById('generate-btn');
        const passwordResult = document.getElementById('password-result');
        const copyBtn = document.getElementById('copy-btn');
        const passwordHash = document.getElementById('password-hash');
        const strengthBar = document.getElementById('strength-bar');
        const strengthLabel = document.getElementById('strength-label');
        const historyList = document.getElementById('history-list');
        const clearHistoryBtn = document.getElementById('clear-history');
        
        // Character sets
        const charSets = {
            uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
            lowercase: 'abcdefghijklmnopqrstuvwxyz',
            numbers: '0123456789',
            symbols: '!@#$%^&*()_+-=[]{}|;:,.<>?'
        };
        
        // Ambiguous characters to exclude
        const ambiguousChars = 'lI1O0';
        
        // Update length value display
        lengthSlider.addEventListener('input', () => {
            lengthValue.textContent = lengthSlider.value;
        });
        
        // Generate password
        generateBtn.addEventListener('click', () => {
            const length = parseInt(lengthSlider.value);
            const useUppercase = uppercaseCheckbox.checked;
            const useLowercase = lowercaseCheckbox.checked;
            const useNumbers = numbersCheckbox.checked;
            const useSymbols = symbolsCheckbox.checked;
            const excludeAmbiguous = ambiguousCheckbox.checked;
            
            // Validate at least one character set is selected
            if (!useUppercase && !useLowercase && !useNumbers && !useSymbols) {
                alert('Выберите хотя бы один набор символов для генерации пароля!');
                return;
            }
            
            // Build character pool
            let charPool = '';
            if (useUppercase) charPool += charSets.uppercase;
            if (useLowercase) charPool += charSets.lowercase;
            if (useNumbers) charPool += charSets.numbers;
            if (useSymbols) charPool += charSets.symbols;
            
            // Remove ambiguous characters if needed
            if (excludeAmbiguous) {
                charPool = charPool.split('').filter(c => !ambiguousChars.includes(c)).join('');
            }
            
            // Generate password
            let password = '';
            const crypto = window.crypto || window.msCrypto;
            const values = new Uint32Array(length);
            
            if (crypto && crypto.getRandomValues) {
                crypto.getRandomValues(values);
                for (let i = 0; i < length; i++) {
                    password += charPool[values[i] % charPool.length];
                }
            } else {
                // Fallback for browsers without crypto support
                for (let i = 0; i < length; i++) {
                    password += charPool[Math.floor(Math.random() * charPool.length)];
                }
            }
            
            // Display password
            passwordResult.textContent = password;
            
            // Calculate hash
            calculateHash(password);
            
            // Calculate strength
            calculateStrength(password);
            
            // Add to history
            addToHistory(password);
        });
        
        // Calculate password hash
        async function calculateHash(password) {
            if (window.crypto && window.crypto.subtle) {
                const encoder = new TextEncoder();
                const data = encoder.encode(password);
                const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                const hashArray = Array.from(new Uint8Array(hashBuffer));
                const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
                passwordHash.value = hashHex;
            } else {
                passwordHash.value = 'SHA-256 не поддерживается в вашем браузере';
            }
        }
        
        // Calculate password strength
        function calculateStrength(password) {
            let score = 0;
            const length = password.length;
            
            // Length score
            if (length > 12) score += 2;
            else if (length > 8) score += 1;
            
            // Character variety score
            const hasUppercase = /[A-Z]/.test(password);
            const hasLowercase = /[a-z]/.test(password);
            const hasNumbers = /[0-9]/.test(password);
            const hasSymbols = /[^A-Za-z0-9]/.test(password);
            
            const varietyCount = [hasUppercase, hasLowercase, hasNumbers, hasSymbols].filter(Boolean).length;
            score += varietyCount - 1;
            
            // Deductions for patterns
            if (/^[a-z]+$/.test(password)) score = Math.max(0, score - 1);
            if (/^[A-Z]+$/.test(password)) score = Math.max(0, score - 1);
            if (/^[0-9]+$/.test(password)) score = Math.max(0, score - 1);
            if (/(.)\1{2,}/.test(password)) score = Math.max(0, score - 1); // repeated chars
            
            // Calculate percentage (0-100)
            const percentage = Math.min(100, Math.max(0, score * 25));
            
            // Update strength meter
            strengthBar.style.width = `${percentage}%`;
            
            // Set strength class and label
            let strengthClass, strengthText;
            if (percentage < 25) {
                strengthClass = 'strength-weak';
                strengthText = 'Слабый';
            } else if (percentage < 50) {
                strengthClass = 'strength-medium';
                strengthText = 'Средний';
            } else if (percentage < 75) {
                strengthClass = 'strength-strong';
                strengthText = 'Сильный';
            } else {
                strengthClass = 'strength-very-strong';
                strengthText = 'Очень сильный';
            }
            
            strengthBar.className = 'strength-bar ' + strengthClass;
            strengthLabel.textContent = `Сложность: ${strengthText}`;
            strengthLabel.style.color = getComputedStyle(strengthBar).backgroundColor;
        }
        
        // Copy password to clipboard
        copyBtn.addEventListener('click', () => {
            const password = passwordResult.textContent;
            if (password && password !== 'Нажмите кнопку "Сгенерировать"') {
                navigator.clipboard.writeText(password).then(() => {
                    const originalText = copyBtn.textContent;
                    copyBtn.textContent = 'Скопировано!';
                    setTimeout(() => {
                        copyBtn.textContent = originalText;
                    }, 2000);
                }).catch(err => {
                    console.error('Не удалось скопировать пароль: ', err);
                    alert('Не удалось скопировать пароль. Попробуйте выделить и скопировать вручную.');
                });
            }
        });
        
        // Password history functions
        function loadHistory() {
            const history = JSON.parse(localStorage.getItem('passwordHistory') || '[]');
            renderHistory(history);
        }
        
        function addToHistory(password) {
            let history = JSON.parse(localStorage.getItem('passwordHistory') || '[]');
            
            // Remove if already exists
            history = history.filter(item => item.password !== password);
            
            // Add to beginning
            history.unshift({
                password: password,
                timestamp: new Date().toISOString()
            });
            
            // Keep only last 10
            if (history.length > 10) {
                history = history.slice(0, 10);
            }
            
            localStorage.setItem('passwordHistory', JSON.stringify(history));
            renderHistory(history);
        }
        
        function renderHistory(history) {
            if (history.length === 0) {
                historyList.innerHTML = '<li class="history-item">Нет сохраненных паролей</li>';
                return;
            }
            
            historyList.innerHTML = '';
            history.forEach(item => {
                const li = document.createElement('li');
                li.className = 'history-item';
                
                const date = new Date(item.timestamp);
                const timeString = date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                const dateString = date.toLocaleDateString();
                
                li.innerHTML = `
                    <span>${item.password}</span>
                    <div>
                        <small>${dateString} ${timeString}</small>
                        <button class="copy-btn" data-password="${item.password}">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                `;
                
                historyList.appendChild(li);
            });
            
            // Add event listeners to copy buttons
            document.querySelectorAll('.copy-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const password = e.currentTarget.getAttribute('data-password');
                    navigator.clipboard.writeText(password).then(() => {
                        e.currentTarget.innerHTML = '<i class="fas fa-check"></i>';
                        setTimeout(() => {
                            e.currentTarget.innerHTML = '<i class="fas fa-copy"></i>';
                        }, 2000);
                    });
                });
            });
        }
        
        clearHistoryBtn.addEventListener('click', () => {
            localStorage.removeItem('passwordHistory');
            renderHistory([]);
        });
        
        // Initialize
        loadHistory();
    </script>
    <script src="../script.js"></script>
</body>
</html>